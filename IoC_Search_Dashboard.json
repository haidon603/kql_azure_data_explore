{"$schema":"https://dataexplorer.azure.com/static/d/schema/52/dashboard.json","id":"457f0b51-194f-41c8-babf-6335b3a485eb","eTag":"0c70c6f5-9c68-4a82-a2d0-375dedb972f3","schema_version":"52","title":"Indicator of Compromise Investigation","tiles":[{"id":"4ffda0c5-a2c9-4796-bb4c-1a3ddeab573d","title":"","visualType":"markdownCard","pageId":"5769b90d-4c07-4317-b341-7bfb7999c975","layout":{"x":0,"y":0,"width":24,"height":8},"markdownText":"-- Dashboard Instructions --\r\n1. Navigate to a database page from the navigation pane on the left\r\n2. Insert a search term\r\n2. Adjust Time Frame. For best performance, adjust the time down to small increments e.g 1-3 hour chunks rather than 'last 7 days'\r\n3. Click through the database pages to determine if the term was seen in our logs ('Ctrl + F' can help identify where a term was found)\r\n\r\n-- Notes --\r\n- For convenience, the search term and time selection will pre-populate across all of the database pages\r\n- The term can be in the format of a string or digit like an IP, email, username, hostname, dll, etc.)\r\n- For purposes of query efficiency, ONLY 500 RANDOM LOGS ARE RETRIEVED. This means that:\r\n     1. The absence of logs does *NOT* necessarily imply the term is absent in our logs. \r\n     2. The presence of the term in some tables but not others does *NOT* mean the term is not also present in other tables.\r\n- Below is a list of every ADX Database and their respective table count. This data is \"live\" and pulled each time this dashboard is loaded. \r\n- The database pages are current as of 1/22/2025. For every new database this dashboard will need a new page. This can be done with relative ease by cloning a page and swapping the database info. ","visualOptions":{}},{"id":"d17ecee8-8630-491c-9e92-15df281f1f1a","title":"Infrastructure Database - 500 raw logs ","visualType":"table","pageId":"2449b420-1377-45bb-9a55-57571f4163cb","layout":{"x":0,"y":0,"width":24,"height":16},"queryRef":{"kind":"query","queryId":"4c4a3309-fae0-4be4-9b10-f1d0c946c973"},"visualOptions":{"table__enableRenderLinks":true,"colorRulesDisabled":false,"colorStyle":"light","crossFilterDisabled":false,"drillthroughDisabled":false,"crossFilter":[],"drillthrough":[],"table__renderLinks":[],"colorRules":[{"id":"c847bf64-f37a-4682-b8c6-4d0db8dcf7e8","ruleType":"colorByValue","ruleName":"","applyTo":"cells","column":"_TableName","themeName":null,"maxValue":null,"minValue":null,"reverseTheme":false,"visualType":"table"},{"id":"d0ee3618-85ad-4106-bbeb-b3daec218c7e","ruleType":"colorByValue","ruleName":"","applyTo":"cells","column":"dcount_record","themeName":"yellow","maxValue":null,"minValue":null,"reverseTheme":true,"visualType":"table"}]}},{"id":"0f2787ab-59cd-40b7-be47-d6bc25598cc2","title":"Application Database - 500 raw logs ","visualType":"table","pageId":"4f7c3e56-a4ae-45e8-819d-43d74f6926a9","layout":{"x":0,"y":0,"width":24,"height":16},"queryRef":{"kind":"query","queryId":"160c7181-5abd-4b92-b58b-3652c6a8e43a"},"description":"Search developed that accepts a tokenized search term (string or digits are accepted) and looks across all tables in a database for it. search is essentially this\n | where record contains (user_supplied_term)\n\nThis hopefully overcomes any adx data quality issues. though, this is wildly inefficient. the problem is without a CIM there is no way to say only search this column because we know IP should/would never be in a column titled 'username' so we are forced to search the entire raw log. \n\n \nExplored efficiency options such as using top 100 by _Tablename vs take 100. The latter is significantly quicker with the caveat that is pulls a RANDOM sample of logs.\n\n \nAdding quotes to search term so that IPs or really anything delimited with a period is not spliced on back end. i.e 1.1.1.1 is not searched as 1 AND 1 AND 1 AND 1.\n\n---------------------------------------\n\nfound out that 21 tables do not contain a record column so these database pages contain a little extra KQL magic to address this.\n.show databases schema\n| where ColumnName != \"\"\n| project TableName, DatabaseName, ColumnName\n| summarize make_set(ColumnName),make_set(TableName), Count_of_Columns=count(ColumnName) by  DatabaseName, TableName\n| where set_ColumnName !has 'record'\n| sort by DatabaseName asc","visualOptions":{"table__enableRenderLinks":true,"colorRulesDisabled":false,"colorStyle":"light","crossFilterDisabled":false,"drillthroughDisabled":false,"crossFilter":[],"drillthrough":[],"table__renderLinks":[],"colorRules":[{"id":"c847bf64-f37a-4682-b8c6-4d0db8dcf7e8","ruleType":"colorByValue","ruleName":"","applyTo":"cells","column":"_TableName","themeName":null,"maxValue":null,"minValue":null,"reverseTheme":false,"visualType":"table"},{"id":"d0ee3618-85ad-4106-bbeb-b3daec218c7e","ruleType":"colorByValue","ruleName":"","applyTo":"cells","column":"dcount_record","themeName":"yellow","maxValue":null,"minValue":null,"reverseTheme":true,"visualType":"table"}]}},{"id":"ef7f6fcd-47dd-4208-bd0b-48ff40944d7a","title":"ConfigurationManagement Database - 500 raw logs ","visualType":"table","pageId":"b8b9d52e-9081-4c39-b7a9-5c8fcea49caa","layout":{"x":0,"y":0,"width":24,"height":16},"queryRef":{"kind":"query","queryId":"bea90610-00ae-40f1-9c54-da893e850b82"},"visualOptions":{"table__enableRenderLinks":true,"colorRulesDisabled":false,"colorStyle":"light","crossFilterDisabled":false,"drillthroughDisabled":false,"crossFilter":[],"drillthrough":[],"table__renderLinks":[],"colorRules":[{"id":"c847bf64-f37a-4682-b8c6-4d0db8dcf7e8","ruleType":"colorByValue","ruleName":"","applyTo":"cells","column":"_TableName","themeName":null,"maxValue":null,"minValue":null,"reverseTheme":false,"visualType":"table"},{"id":"d0ee3618-85ad-4106-bbeb-b3daec218c7e","ruleType":"colorByValue","ruleName":"","applyTo":"cells","column":"dcount_record","themeName":"yellow","maxValue":null,"minValue":null,"reverseTheme":true,"visualType":"table"}]}},{"id":"1cd01861-7823-4717-b574-2cb592993bea","title":"GenerativeAI Database - 500 raw logs","visualType":"table","pageId":"92adcf12-58b6-4a67-8d8e-f1e32979a563","layout":{"x":0,"y":0,"width":24,"height":16},"queryRef":{"kind":"query","queryId":"31d727f6-dcbf-4fa0-bf0c-0573bcd79816"},"visualOptions":{"table__enableRenderLinks":true,"colorRulesDisabled":false,"colorStyle":"light","crossFilterDisabled":false,"drillthroughDisabled":false,"crossFilter":[],"drillthrough":[],"table__renderLinks":[],"colorRules":[{"id":"c847bf64-f37a-4682-b8c6-4d0db8dcf7e8","ruleType":"colorByValue","ruleName":"","applyTo":"cells","column":"_TableName","themeName":null,"maxValue":null,"minValue":null,"reverseTheme":false,"visualType":"table"},{"id":"d0ee3618-85ad-4106-bbeb-b3daec218c7e","ruleType":"colorByValue","ruleName":"","applyTo":"cells","column":"dcount_record","themeName":"yellow","maxValue":null,"minValue":null,"reverseTheme":true,"visualType":"table"}]}},{"id":"59c301be-892d-4cd1-9d0d-261bfb8eeb17","title":"Identity Database - 500 raw logs","visualType":"table","pageId":"449a06fd-5ee9-4066-8ceb-eda80b32fd88","layout":{"x":0,"y":0,"width":24,"height":16},"queryRef":{"kind":"query","queryId":"c77a3dc1-1d2e-4090-8c93-cc4f495f8163"},"visualOptions":{"table__enableRenderLinks":true,"colorRulesDisabled":false,"colorStyle":"light","crossFilterDisabled":false,"drillthroughDisabled":false,"crossFilter":[],"drillthrough":[],"table__renderLinks":[],"colorRules":[{"id":"c847bf64-f37a-4682-b8c6-4d0db8dcf7e8","ruleType":"colorByValue","ruleName":"","applyTo":"cells","column":"_TableName","themeName":null,"maxValue":null,"minValue":null,"reverseTheme":false,"visualType":"table"},{"id":"d0ee3618-85ad-4106-bbeb-b3daec218c7e","ruleType":"colorByValue","ruleName":"","applyTo":"cells","column":"dcount_record","themeName":"yellow","maxValue":null,"minValue":null,"reverseTheme":true,"visualType":"table"}]}},{"id":"693dd89e-566c-4cdc-b6c0-d7572535a247","title":"Network Database - 500 raw logs ","visualType":"table","pageId":"bb50fd6f-f393-49c2-8d38-c234e1b661eb","layout":{"x":0,"y":0,"width":24,"height":16},"queryRef":{"kind":"query","queryId":"73287ecb-4abd-43ea-9ae8-5ac5335a1619"},"visualOptions":{"table__enableRenderLinks":true,"colorRulesDisabled":false,"colorStyle":"light","crossFilterDisabled":false,"drillthroughDisabled":false,"crossFilter":[],"drillthrough":[],"table__renderLinks":[],"colorRules":[{"id":"c847bf64-f37a-4682-b8c6-4d0db8dcf7e8","ruleType":"colorByValue","ruleName":"","applyTo":"cells","column":"_TableName","themeName":null,"maxValue":null,"minValue":null,"reverseTheme":false,"visualType":"table"},{"id":"d0ee3618-85ad-4106-bbeb-b3daec218c7e","ruleType":"colorByValue","ruleName":"","applyTo":"cells","column":"dcount_record","themeName":"yellow","maxValue":null,"minValue":null,"reverseTheme":true,"visualType":"table"}]}},{"id":"8858772c-3868-4d83-8f34-916f13e1087d","title":"ThreatIntel Database - 500 raw logs ","visualType":"table","pageId":"f7816c1e-e08d-443a-929f-cef741e241d2","layout":{"x":0,"y":0,"width":24,"height":16},"queryRef":{"kind":"query","queryId":"b8b19709-8b89-424a-85c4-217cc8512ebc"},"visualOptions":{"table__enableRenderLinks":true,"colorRulesDisabled":false,"colorStyle":"light","crossFilterDisabled":false,"drillthroughDisabled":false,"crossFilter":[],"drillthrough":[],"table__renderLinks":[],"colorRules":[{"id":"c847bf64-f37a-4682-b8c6-4d0db8dcf7e8","ruleType":"colorByValue","ruleName":"","applyTo":"cells","column":"_TableName","themeName":null,"maxValue":null,"minValue":null,"reverseTheme":false,"visualType":"table"},{"id":"d0ee3618-85ad-4106-bbeb-b3daec218c7e","ruleType":"colorByValue","ruleName":"","applyTo":"cells","column":"dcount_record","themeName":"yellow","maxValue":null,"minValue":null,"reverseTheme":true,"visualType":"table"}]}},{"id":"7330c72d-b3fc-4b95-a6a2-a94071b6c403","title":"VulnManagement Database - 500 raw logs ","visualType":"table","pageId":"64e17081-dd19-45ea-9bd9-99897047fe24","layout":{"x":0,"y":0,"width":24,"height":16},"queryRef":{"kind":"query","queryId":"9b4c4ab0-0a9b-45e0-a75e-5904fdf7a148"},"visualOptions":{"table__enableRenderLinks":true,"colorRulesDisabled":false,"colorStyle":"light","crossFilterDisabled":false,"drillthroughDisabled":false,"crossFilter":[],"drillthrough":[],"table__renderLinks":[],"colorRules":[{"id":"c847bf64-f37a-4682-b8c6-4d0db8dcf7e8","ruleType":"colorByValue","ruleName":"","applyTo":"cells","column":"_TableName","themeName":null,"maxValue":null,"minValue":null,"reverseTheme":false,"visualType":"table"},{"id":"d0ee3618-85ad-4106-bbeb-b3daec218c7e","ruleType":"colorByValue","ruleName":"","applyTo":"cells","column":"dcount_record","themeName":"yellow","maxValue":null,"minValue":null,"reverseTheme":true,"visualType":"table"}]}},{"id":"915fdc54-666b-4d5b-b58a-3fd4ae11751e","title":"ADX Databases","visualType":"table","pageId":"5769b90d-4c07-4317-b341-7bfb7999c975","layout":{"x":0,"y":8,"width":6,"height":11},"queryRef":{"kind":"query","queryId":"94bd4c82-b354-4303-bbeb-434423017c43"},"visualOptions":{"table__enableRenderLinks":true,"colorRulesDisabled":false,"colorStyle":"light","crossFilterDisabled":false,"drillthroughDisabled":false,"crossFilter":[],"drillthrough":[],"table__renderLinks":[],"colorRules":[{"id":"612eb301-a80f-44c5-b1b0-68319483aa6b","ruleType":"colorByValue","ruleName":"","applyTo":"cells","column":"DatabaseName","themeName":null,"maxValue":null,"minValue":null,"reverseTheme":false,"visualType":"table"},{"id":"8b4f73ef-7d40-46c1-9160-89c5f7ee829d","ruleType":"colorByValue","ruleName":"","applyTo":"cells","column":"NumberOfTables","themeName":"yellow","maxValue":null,"minValue":null,"reverseTheme":true,"visualType":"table"},{"id":"560619b7-65f3-4e4b-8fdb-72ea8261efbf","ruleType":"colorByValue","ruleName":"","applyTo":"cells","column":"TotalSize","themeName":"cold","maxValue":null,"minValue":null,"reverseTheme":true,"visualType":"table"}]}},{"id":"83cb1041-5029-42fe-a7b4-7a88e986511d","title":"Tables within the Application Database","visualType":"table","pageId":"4f7c3e56-a4ae-45e8-819d-43d74f6926a9","layout":{"x":0,"y":16,"width":24,"height":10},"queryRef":{"kind":"query","queryId":"82171e1a-a3ec-4c6f-94c5-d94abb1a61e0"},"visualOptions":{"table__enableRenderLinks":true,"colorRulesDisabled":false,"colorStyle":"light","crossFilterDisabled":false,"drillthroughDisabled":false,"crossFilter":[],"drillthrough":[],"table__renderLinks":[],"colorRules":[{"id":"d2ef6f68-012f-4b32-b665-d966918427b8","ruleType":"colorByValue","ruleName":"","applyTo":"cells","column":"TotalExtents","themeName":"yellow","maxValue":null,"minValue":null,"reverseTheme":true,"visualType":"table"},{"id":"6a9af55f-2c55-4ae3-9c2a-48ad188cf7d7","ruleType":"colorByValue","ruleName":"","applyTo":"cells","column":"TableName","themeName":null,"maxValue":null,"minValue":null,"reverseTheme":false,"visualType":"table"}]}},{"id":"ee46fc79-8add-4fa7-b3ab-c6d04cd3851f","title":"Tables within the ConfigurationManagement Database","visualType":"table","pageId":"b8b9d52e-9081-4c39-b7a9-5c8fcea49caa","layout":{"x":0,"y":16,"width":24,"height":10},"queryRef":{"kind":"query","queryId":"632872e9-bb27-4122-80d1-189fbdf8ebc6"},"visualOptions":{"table__enableRenderLinks":true,"colorRulesDisabled":false,"colorStyle":"light","crossFilterDisabled":false,"drillthroughDisabled":false,"crossFilter":[],"drillthrough":[],"table__renderLinks":[],"colorRules":[{"id":"d2ef6f68-012f-4b32-b665-d966918427b8","ruleType":"colorByValue","ruleName":"","applyTo":"cells","column":"TotalExtents","themeName":"yellow","maxValue":null,"minValue":null,"reverseTheme":true,"visualType":"table"},{"id":"6a9af55f-2c55-4ae3-9c2a-48ad188cf7d7","ruleType":"colorByValue","ruleName":"","applyTo":"cells","column":"TableName","themeName":null,"maxValue":null,"minValue":null,"reverseTheme":false,"visualType":"table"}]}},{"id":"a31c1e5e-5df9-4080-aa19-d4e75c66935e","title":"Tables within the Endpoint Database","visualType":"table","pageId":"c5e69c20-730e-4a5f-b84d-305f07e2e86c","layout":{"x":0,"y":24,"width":24,"height":10},"queryRef":{"kind":"query","queryId":"68e99f7c-4e2e-4a47-ad9d-c8223a16a5e6"},"visualOptions":{"table__enableRenderLinks":true,"colorRulesDisabled":false,"colorStyle":"light","crossFilterDisabled":false,"drillthroughDisabled":false,"crossFilter":[],"drillthrough":[],"table__renderLinks":[],"colorRules":[{"id":"d2ef6f68-012f-4b32-b665-d966918427b8","ruleType":"colorByValue","ruleName":"","applyTo":"cells","column":"TotalExtents","themeName":"yellow","maxValue":null,"minValue":null,"reverseTheme":true,"visualType":"table"},{"id":"6a9af55f-2c55-4ae3-9c2a-48ad188cf7d7","ruleType":"colorByValue","ruleName":"","applyTo":"cells","column":"TableName","themeName":null,"maxValue":null,"minValue":null,"reverseTheme":false,"visualType":"table"}]}},{"id":"3849e958-de4b-465f-9a07-30edff46e5a0","title":"Tables within the GenerativeAI Database","visualType":"table","pageId":"92adcf12-58b6-4a67-8d8e-f1e32979a563","layout":{"x":0,"y":16,"width":24,"height":10},"queryRef":{"kind":"query","queryId":"5808f3f2-cbaa-4e28-b8a0-03a7946db20c"},"visualOptions":{"table__enableRenderLinks":true,"colorRulesDisabled":false,"colorStyle":"light","crossFilterDisabled":false,"drillthroughDisabled":false,"crossFilter":[],"drillthrough":[],"table__renderLinks":[],"colorRules":[{"id":"d2ef6f68-012f-4b32-b665-d966918427b8","ruleType":"colorByValue","ruleName":"","applyTo":"cells","column":"TotalExtents","themeName":"yellow","maxValue":null,"minValue":null,"reverseTheme":true,"visualType":"table"},{"id":"6a9af55f-2c55-4ae3-9c2a-48ad188cf7d7","ruleType":"colorByValue","ruleName":"","applyTo":"cells","column":"TableName","themeName":null,"maxValue":null,"minValue":null,"reverseTheme":false,"visualType":"table"}]}},{"id":"fad5487c-6b29-48a9-b43f-28d378d9a79a","title":"Tables within the Identity Database","visualType":"table","pageId":"449a06fd-5ee9-4066-8ceb-eda80b32fd88","layout":{"x":0,"y":16,"width":24,"height":12},"queryRef":{"kind":"query","queryId":"a02acbdf-ae92-4aa4-aead-763dd1ac5125"},"visualOptions":{"table__enableRenderLinks":true,"colorRulesDisabled":false,"colorStyle":"light","crossFilterDisabled":false,"drillthroughDisabled":false,"crossFilter":[],"drillthrough":[],"table__renderLinks":[],"colorRules":[{"id":"d2ef6f68-012f-4b32-b665-d966918427b8","ruleType":"colorByValue","ruleName":"","applyTo":"cells","column":"TotalExtents","themeName":"yellow","maxValue":null,"minValue":null,"reverseTheme":true,"visualType":"table"},{"id":"6a9af55f-2c55-4ae3-9c2a-48ad188cf7d7","ruleType":"colorByValue","ruleName":"","applyTo":"cells","column":"TableName","themeName":null,"maxValue":null,"minValue":null,"reverseTheme":false,"visualType":"table"}]}},{"id":"0e329233-bc3e-4e2f-848b-362ee063f45c","title":"Tables within the Infrastructure Database","visualType":"table","pageId":"2449b420-1377-45bb-9a55-57571f4163cb","layout":{"x":0,"y":16,"width":24,"height":17},"queryRef":{"kind":"query","queryId":"43029220-1102-464d-afc1-f36588f8c59f"},"visualOptions":{"table__enableRenderLinks":true,"colorRulesDisabled":false,"colorStyle":"light","crossFilterDisabled":false,"drillthroughDisabled":false,"crossFilter":[],"drillthrough":[],"table__renderLinks":[],"colorRules":[{"id":"d2ef6f68-012f-4b32-b665-d966918427b8","ruleType":"colorByValue","ruleName":"","applyTo":"cells","column":"TotalExtents","themeName":"yellow","maxValue":null,"minValue":null,"reverseTheme":true,"visualType":"table"},{"id":"6a9af55f-2c55-4ae3-9c2a-48ad188cf7d7","ruleType":"colorByValue","ruleName":"","applyTo":"cells","column":"TableName","themeName":null,"maxValue":null,"minValue":null,"reverseTheme":false,"visualType":"table"}]}},{"id":"7812b5a7-fd2d-42de-89ca-d042d817e27d","title":"Tables within the Network Database","hideTitle":true,"visualType":"table","pageId":"bb50fd6f-f393-49c2-8d38-c234e1b661eb","layout":{"x":0,"y":16,"width":24,"height":12},"queryRef":{"kind":"query","queryId":"95bdef38-2888-4613-acd7-5c1f43dcb49f"},"visualOptions":{"table__enableRenderLinks":true,"colorRulesDisabled":false,"colorStyle":"light","crossFilterDisabled":false,"drillthroughDisabled":false,"crossFilter":[],"drillthrough":[],"table__renderLinks":[],"colorRules":[{"id":"d2ef6f68-012f-4b32-b665-d966918427b8","ruleType":"colorByValue","ruleName":"","applyTo":"cells","column":"TotalExtents","themeName":"yellow","maxValue":null,"minValue":null,"reverseTheme":true,"visualType":"table"},{"id":"6a9af55f-2c55-4ae3-9c2a-48ad188cf7d7","ruleType":"colorByValue","ruleName":"","applyTo":"cells","column":"TableName","themeName":null,"maxValue":null,"minValue":null,"reverseTheme":false,"visualType":"table"}]}},{"id":"aa29d4b6-f606-44ef-9605-0ed749eff237","title":"Tables within the ThreatIntel Database","visualType":"table","pageId":"f7816c1e-e08d-443a-929f-cef741e241d2","layout":{"x":0,"y":16,"width":24,"height":10},"queryRef":{"kind":"query","queryId":"220cb91f-ea63-4fb6-95f7-7c080f85a3a3"},"visualOptions":{"table__enableRenderLinks":true,"colorRulesDisabled":false,"colorStyle":"light","crossFilterDisabled":false,"drillthroughDisabled":false,"crossFilter":[],"drillthrough":[],"table__renderLinks":[],"colorRules":[{"id":"d2ef6f68-012f-4b32-b665-d966918427b8","ruleType":"colorByValue","ruleName":"","applyTo":"cells","column":"TotalExtents","themeName":"yellow","maxValue":null,"minValue":null,"reverseTheme":true,"visualType":"table"},{"id":"6a9af55f-2c55-4ae3-9c2a-48ad188cf7d7","ruleType":"colorByValue","ruleName":"","applyTo":"cells","column":"TableName","themeName":null,"maxValue":null,"minValue":null,"reverseTheme":false,"visualType":"table"}]}},{"id":"e57c13ec-05f1-4e17-9c70-51ef3e0f592f","title":"Tables within the VulnManagement Database","visualType":"table","pageId":"64e17081-dd19-45ea-9bd9-99897047fe24","layout":{"x":0,"y":16,"width":24,"height":10},"queryRef":{"kind":"query","queryId":"32cdeb14-e742-4164-aedb-286dec339514"},"visualOptions":{"table__enableRenderLinks":true,"colorRulesDisabled":false,"colorStyle":"light","crossFilterDisabled":false,"drillthroughDisabled":false,"crossFilter":[],"drillthrough":[],"table__renderLinks":[],"colorRules":[{"id":"d2ef6f68-012f-4b32-b665-d966918427b8","ruleType":"colorByValue","ruleName":"","applyTo":"cells","column":"TotalExtents","themeName":"yellow","maxValue":null,"minValue":null,"reverseTheme":true,"visualType":"table"},{"id":"6a9af55f-2c55-4ae3-9c2a-48ad188cf7d7","ruleType":"colorByValue","ruleName":"","applyTo":"cells","column":"TableName","themeName":null,"maxValue":null,"minValue":null,"reverseTheme":false,"visualType":"table"}]}},{"id":"96ad0c21-5766-4019-84bf-e3784541f3a7","title":"All of the available ADX tables their respective columns","visualType":"table","pageId":"5769b90d-4c07-4317-b341-7bfb7999c975","layout":{"x":6,"y":8,"width":18,"height":11},"queryRef":{"kind":"query","queryId":"d94035e0-2962-4bea-a7dc-a06f4b7ab5d7"},"description":".show databases schema\n| where ColumnName != \"\"\n| project TableName, DatabaseName, ColumnName\n| summarize make_set(ColumnName),make_set(TableName), Count_of_Columns=count(ColumnName) by  DatabaseName, TableName\n//| where set_ColumnName !contains 'record'\n| sort by DatabaseName asc","visualOptions":{"table__enableRenderLinks":true,"colorRulesDisabled":false,"colorStyle":"light","crossFilterDisabled":false,"drillthroughDisabled":false,"crossFilter":[],"drillthrough":[],"table__renderLinks":[],"colorRules":[{"id":"9ef021ce-ba89-4790-9225-c906cfe81bb1","ruleType":"colorByValue","ruleName":"","applyTo":"cells","column":"DatabaseName","themeName":null,"maxValue":null,"minValue":null,"reverseTheme":false,"visualType":"table"},{"id":"ef4c4b40-9650-4a91-8781-1ad789f4c27a","ruleType":"colorByValue","ruleName":"","applyTo":"cells","column":"Count_of_Columns","themeName":"yellow","maxValue":null,"minValue":null,"reverseTheme":false,"visualType":"table"}]}},{"id":"ccac7e3c-5e3e-4367-8a92-6e711b940f35","title":"Endpoint Database - 500 raw logs ","visualType":"table","pageId":"c5e69c20-730e-4a5f-b84d-305f07e2e86c","layout":{"x":0,"y":0,"width":24,"height":16},"queryRef":{"kind":"query","queryId":"6adfc8a2-2560-42e6-8e7b-73002377f51a"},"visualOptions":{"table__enableRenderLinks":true,"colorRulesDisabled":false,"colorStyle":"light","crossFilterDisabled":false,"drillthroughDisabled":false,"crossFilter":[],"drillthrough":[],"table__renderLinks":[],"colorRules":[{"id":"c847bf64-f37a-4682-b8c6-4d0db8dcf7e8","ruleType":"colorByValue","ruleName":"","applyTo":"cells","column":"_TableName","themeName":null,"maxValue":null,"minValue":null,"reverseTheme":false,"visualType":"table"},{"id":"d0ee3618-85ad-4106-bbeb-b3daec218c7e","ruleType":"colorByValue","ruleName":"","applyTo":"cells","column":"dcount_record","themeName":"yellow","maxValue":null,"minValue":null,"reverseTheme":true,"visualType":"table"}]}}],"baseQueries":[],"parameters":[{"kind":"duration","id":"33adf2e3-b98c-49d6-9e36-020efba06e87","displayName":"Time range","description":"","beginVariableName":"_startTime","endVariableName":"_endTime","defaultValue":{"kind":"dynamic","count":15,"unit":"minutes"},"showOnPages":{"kind":"selection","pageIds":["4f7c3e56-a4ae-45e8-819d-43d74f6926a9","b8b9d52e-9081-4c39-b7a9-5c8fcea49caa","f7816c1e-e08d-443a-929f-cef741e241d2","64e17081-dd19-45ea-9bd9-99897047fe24","95572933-1053-4c56-b660-d07bdfc597a9","bb50fd6f-f393-49c2-8d38-c234e1b661eb","714292b0-dccc-437c-a4e9-74b44efbbdeb","2449b420-1377-45bb-9a55-57571f4163cb","449a06fd-5ee9-4066-8ceb-eda80b32fd88","92adcf12-58b6-4a67-8d8e-f1e32979a563","c5e69c20-730e-4a5f-b84d-305f07e2e86c"]}},{"kind":"string","selectionType":"freetext","id":"28295aa2-69de-44a5-8804-86ce1e563eaa","displayName":"Search Term:","variableName":"term_t","description":"","defaultValue":{"kind":"all"},"showOnPages":{"kind":"selection","pageIds":["4f7c3e56-a4ae-45e8-819d-43d74f6926a9","95572933-1053-4c56-b660-d07bdfc597a9","714292b0-dccc-437c-a4e9-74b44efbbdeb","bb50fd6f-f393-49c2-8d38-c234e1b661eb","f7816c1e-e08d-443a-929f-cef741e241d2","64e17081-dd19-45ea-9bd9-99897047fe24","2449b420-1377-45bb-9a55-57571f4163cb","449a06fd-5ee9-4066-8ceb-eda80b32fd88","92adcf12-58b6-4a67-8d8e-f1e32979a563","c5e69c20-730e-4a5f-b84d-305f07e2e86c","b8b9d52e-9081-4c39-b7a9-5c8fcea49caa"]}}],"dataSources":[{"id":"e2531940-8a59-446c-8122-da1fb5dc7e6f","name":"Endpoint","scopeId":"kusto","clusterUri":"https://mpprdcuscybengadx.centralus.kusto.windows.net/","database":"Endpoint","kind":"manual-kusto"},{"id":"2c78a782-7019-4c26-87f0-28442ace49d5","name":"Network","scopeId":"kusto","clusterUri":"https://mpprdcuscybengadx.centralus.kusto.windows.net/","database":"Network","kind":"manual-kusto"},{"id":"500e3f05-5852-4ed8-97e4-0a49dba0743f","kind":"manual-kusto","scopeId":"kusto","name":"mpprdcuscybengadx.centralus","clusterUri":"https://mpprdcuscybengadx.centralus.kusto.windows.net/","database":"Application"},{"id":"725c397c-140c-4224-98ac-187034c48afc","kind":"manual-kusto","scopeId":"kusto","name":"mpprdcuscybengadx.centralus-2","clusterUri":"https://mpprdcuscybengadx.centralus.kusto.windows.net/","database":"ConfigurationManagement"},{"id":"989ca0ff-d24e-4abe-9a38-1f063f79eab7","kind":"manual-kusto","scopeId":"kusto","name":"mpprdcuscybengadx.centralus-3","clusterUri":"https://mpprdcuscybengadx.centralus.kusto.windows.net/","database":"GenerativeAI"},{"id":"a27deea7-3d4e-4efb-884f-d6e68c3573b5","kind":"manual-kusto","scopeId":"kusto","name":"mpprdcuscybengadx.centralus-4","clusterUri":"https://mpprdcuscybengadx.centralus.kusto.windows.net/","database":"Identity"},{"id":"5cc46738-0576-4831-930f-1b777d638cbf","kind":"manual-kusto","scopeId":"kusto","name":"mpprdcuscybengadx.centralus-5","clusterUri":"https://mpprdcuscybengadx.centralus.kusto.windows.net/","database":"Infrastructure"},{"id":"b55bebac-106f-45ae-8798-4a91cd39218e","kind":"manual-kusto","scopeId":"kusto","name":"mpprdcuscybengadx.centralus-6","clusterUri":"https://mpprdcuscybengadx.centralus.kusto.windows.net/","database":"LogRhythm"},{"id":"ef99a07c-0ba5-4e80-9285-9671a4fdc98d","kind":"manual-kusto","scopeId":"kusto","name":"mpprdcuscybengadx.centralus-7","clusterUri":"https://mpprdcuscybengadx.centralus.kusto.windows.net/","database":"ThreatIntel"},{"id":"363ca8af-5cc7-4858-bc1e-1452751d5393","kind":"manual-kusto","scopeId":"kusto","name":"mpprdcuscybengadx.centralus-8","clusterUri":"https://mpprdcuscybengadx.centralus.kusto.windows.net/","database":"XSOAR"},{"id":"aa450536-a078-4802-99fc-f07f5f47be66","kind":"manual-kusto","scopeId":"kusto","name":"mpprdcuscybengadx.centralus-9","clusterUri":"https://mpprdcuscybengadx.centralus.kusto.windows.net/","database":"VulnManagement"},{"id":"02abb46a-20e5-40c4-a5cc-2773f79bb70e","kind":"manual-kusto","scopeId":"kusto","name":"xsoar","clusterUri":"https://mpprdcuscybengadx.centralus.kusto.windows.net/","database":"XSOAR"}],"pages":[{"name":"General Info","id":"5769b90d-4c07-4317-b341-7bfb7999c975"},{"name":"Application","id":"4f7c3e56-a4ae-45e8-819d-43d74f6926a9"},{"name":"ConfigurationManagement","id":"b8b9d52e-9081-4c39-b7a9-5c8fcea49caa"},{"name":"Endpoint","id":"c5e69c20-730e-4a5f-b84d-305f07e2e86c"},{"name":"GenerativeAI","id":"92adcf12-58b6-4a67-8d8e-f1e32979a563"},{"name":"Identity","id":"449a06fd-5ee9-4066-8ceb-eda80b32fd88"},{"name":"Infrastructure","id":"2449b420-1377-45bb-9a55-57571f4163cb"},{"name":"Network","id":"bb50fd6f-f393-49c2-8d38-c234e1b661eb"},{"name":"ThreatIntel","id":"f7816c1e-e08d-443a-929f-cef741e241d2"},{"name":"VulnManagement","id":"64e17081-dd19-45ea-9bd9-99897047fe24"}],"queries":[{"dataSource":{"kind":"inline","dataSourceId":"5cc46738-0576-4831-930f-1b777d638cbf"},"text":"let findSourceIPLogs = (arg0: string, arg1: string) {\n    union withsource=_TableName *  \n    | where ingestion_time()  between (_startTime .. _endTime)\n};\nfindSourceIPLogs(\"Infrastructure\", (\"term_t\"))\n| where record contains (term_t)\n| take 500\n| summarize\n    make_set(record, 500),\n    dcount(tostring(record)),\n    make_set(ingestion_time(), 500)\n    by _TableName\n| sort by dcount_record","id":"4c4a3309-fae0-4be4-9b10-f1d0c946c973","usedVariables":["_endTime","_startTime","term_t"]},{"dataSource":{"kind":"inline","dataSourceId":"500e3f05-5852-4ed8-97e4-0a49dba0743f"},"text":"let findSourceIPLogs = (arg0: string, arg1: string) {\n    union withsource=_TableName *  \n    | where ingestion_time()  between (_startTime .. _endTime)\n};\nfindSourceIPLogs(\"Application\", (\"term_t\"))\n| where record contains (term_t) or P contains (term_t) // some Application table logs do not contain a 'record' column\n| take 500\n| summarize\n    make_set(record, 500),\n    make_set(P, 500),\n    dcount(tostring(record)),\n    dcount(tostring(P)),\n    make_set(ingestion_time(), 500)\n    by _TableName\n| sort by dcount_record","id":"160c7181-5abd-4b92-b58b-3652c6a8e43a","usedVariables":["_endTime","_startTime","term_t"]},{"dataSource":{"kind":"inline","dataSourceId":"725c397c-140c-4224-98ac-187034c48afc"},"text":"let findSourceIPLogs = (arg0: string, arg1: string) {\n    union withsource=_TableName *  \n    | where ingestion_time()  between (_startTime .. _endTime)\n};\nfindSourceIPLogs(\"ConfigurationManagement\", (\"term_t\"))\n| search (term_t) // Tenable data does not containt a record term | where record contains (term_t) \n| take 500 \n//| summarize\n //   make_set(record, 500),\n  //  dcount(tostring(record)),\n  //  make_set(ingestion_time(), 500)\n   // by _TableName\n//| sort by dcount_record","id":"bea90610-00ae-40f1-9c54-da893e850b82","usedVariables":["_endTime","_startTime","term_t"]},{"dataSource":{"kind":"inline","dataSourceId":"989ca0ff-d24e-4abe-9a38-1f063f79eab7"},"text":"let findSourceIPLogs = (arg0: string, arg1: string) {\n    union withsource=_TableName *  \n    | where ingestion_time()  between (_startTime .. _endTime)\n};\nfindSourceIPLogs(\"GenerativeAI\", (\"term_t\"))\n| where record contains (term_t)\n| take 500\n| summarize\n    make_set(record, 500),\n    dcount(tostring(record)),\n    make_set(ingestion_time(), 500)\n    by _TableName\n| sort by dcount_record","id":"31d727f6-dcbf-4fa0-bf0c-0573bcd79816","usedVariables":["_endTime","_startTime","term_t"]},{"dataSource":{"kind":"inline","dataSourceId":"a27deea7-3d4e-4efb-884f-d6e68c3573b5"},"text":"let findSourceIPLogs = (arg0: string, arg1: string) {\n    union withsource=_TableName *  \n    | where ingestion_time()  between (_startTime .. _endTime)\n};\nfindSourceIPLogs(\"Identity\", (\"term_t\"))\n| where  record contains (term_t) or P contains (term_t) //some Identity table logs do not contain a 'record' column\n| take 500\n| summarize\n    make_set(record, 500),\n    make_set(P,500),\n    dcount(tostring(record)),\n    make_set(ingestion_time(), 500)\n    by _TableName\n| sort by dcount_record","id":"c77a3dc1-1d2e-4090-8c93-cc4f495f8163","usedVariables":["_endTime","_startTime","term_t"]},{"dataSource":{"kind":"inline","dataSourceId":"2c78a782-7019-4c26-87f0-28442ace49d5"},"text":"let findSourceIPLogs = (arg0: string, arg1: string) {\n    union withsource=_TableName *  \n    | where ingestion_time()  between (_startTime .. _endTime)\n};\nfindSourceIPLogs(\"Network\", (\"term_t\"))\n| where record contains (term_t)\n| take 500\n| summarize\n    make_set(record, 500),\n    dcount(tostring(record)),\n    make_set(ingestion_time(), 500)\n    by _TableName\n| sort by dcount_record","id":"73287ecb-4abd-43ea-9ae8-5ac5335a1619","usedVariables":["_endTime","_startTime","term_t"]},{"dataSource":{"kind":"inline","dataSourceId":"ef99a07c-0ba5-4e80-9285-9671a4fdc98d"},"text":"let findSourceIPLogs = (arg0: string, arg1: string) {\n    union withsource=_TableName *  \n    | where ingestion_time()  between (_startTime .. _endTime)\n};\nfindSourceIPLogs(\"ThreatIntel\", (\"term_t\"))\n| where record contains (term_t)\n| take 500\n| summarize\n    make_set(record, 500),\n    dcount(tostring(record)),\n    make_set(ingestion_time(), 500)\n    by _TableName\n| sort by dcount_record","id":"b8b19709-8b89-424a-85c4-217cc8512ebc","usedVariables":["_endTime","_startTime","term_t"]},{"dataSource":{"kind":"inline","dataSourceId":"aa450536-a078-4802-99fc-f07f5f47be66"},"text":"let findSourceIPLogs = (arg0: string, arg1: string) {\n    union withsource=_TableName *  \n    | where ingestion_time()  between (_startTime .. _endTime)\n};\nfindSourceIPLogs(\"VulnManagement\", (\"term_t\"))\n| search (term_t) // Tenable data does not containt a record term | where record contains (term_t) \n| take 500 \n| project\n    record,\n    CISARaw=strcat(notes, \"\", shortDescription, \"\", vulnerabilityName),\n    TenableIOVulnRaw=strcat(asset_fqdn, \"\", asset_ipv4, \"\", plugin_description, \"\", output),\n    _TableName\n| summarize\n    make_set(record, 500),\n    make_set(CISARaw, 500),\n    make_set(TenableIOVulnRaw, 500),\n    dcount(tostring(record)),\n    dcount(tostring(CISARaw)),\n    dcount(tostring(TenableIOVulnRaw))//,\n    // make_set(ingestion_time(), 500)\n    by _TableName\n| sort by dcount_record","id":"9b4c4ab0-0a9b-45e0-a75e-5904fdf7a148","usedVariables":["_endTime","_startTime","term_t"]},{"dataSource":{"kind":"inline","dataSourceId":"500e3f05-5852-4ed8-97e4-0a49dba0743f"},"text":".show databases verbose \r\n| project DatabaseName, Version,NumberOfTables, TotalSize\r\n| sort by NumberOfTables desc ","id":"94bd4c82-b354-4303-bbeb-434423017c43","usedVariables":[]},{"dataSource":{"kind":"inline","dataSourceId":"500e3f05-5852-4ed8-97e4-0a49dba0743f"},"text":".show tables details \n| project TableName, DatabaseName, Folder, TotalExtents, AuthorizedPrincipals\n| sort by TotalExtents desc","id":"82171e1a-a3ec-4c6f-94c5-d94abb1a61e0","usedVariables":[]},{"dataSource":{"kind":"inline","dataSourceId":"725c397c-140c-4224-98ac-187034c48afc"},"text":".show tables details \n| project TableName, DatabaseName, Folder, TotalExtents, AuthorizedPrincipals\n| sort by TotalExtents desc","id":"632872e9-bb27-4122-80d1-189fbdf8ebc6","usedVariables":[]},{"dataSource":{"kind":"inline","dataSourceId":"e2531940-8a59-446c-8122-da1fb5dc7e6f"},"text":".show tables details \n| project TableName, DatabaseName, Folder, TotalExtents, AuthorizedPrincipals\n| sort by TotalExtents desc","id":"68e99f7c-4e2e-4a47-ad9d-c8223a16a5e6","usedVariables":[]},{"dataSource":{"kind":"inline","dataSourceId":"989ca0ff-d24e-4abe-9a38-1f063f79eab7"},"text":".show tables details \n| project TableName, DatabaseName, Folder, TotalExtents, AuthorizedPrincipals\n| sort by TotalExtents desc","id":"5808f3f2-cbaa-4e28-b8a0-03a7946db20c","usedVariables":[]},{"dataSource":{"kind":"inline","dataSourceId":"a27deea7-3d4e-4efb-884f-d6e68c3573b5"},"text":".show tables details \n| project TableName, DatabaseName, Folder, TotalExtents, AuthorizedPrincipals\n| sort by TotalExtents desc","id":"a02acbdf-ae92-4aa4-aead-763dd1ac5125","usedVariables":[]},{"dataSource":{"kind":"inline","dataSourceId":"5cc46738-0576-4831-930f-1b777d638cbf"},"text":".show tables details \n| project TableName, DatabaseName, Folder, TotalExtents, AuthorizedPrincipals\n| sort by TotalExtents desc","id":"43029220-1102-464d-afc1-f36588f8c59f","usedVariables":[]},{"dataSource":{"kind":"inline","dataSourceId":"2c78a782-7019-4c26-87f0-28442ace49d5"},"text":".show tables details \n| project TableName, DatabaseName, Folder, TotalExtents, AuthorizedPrincipals\n| sort by TotalExtents desc","id":"95bdef38-2888-4613-acd7-5c1f43dcb49f","usedVariables":[]},{"dataSource":{"kind":"inline","dataSourceId":"ef99a07c-0ba5-4e80-9285-9671a4fdc98d"},"text":".show tables details \n| project TableName, DatabaseName, Folder, TotalExtents, AuthorizedPrincipals\n| sort by TotalExtents desc","id":"220cb91f-ea63-4fb6-95f7-7c080f85a3a3","usedVariables":[]},{"dataSource":{"kind":"inline","dataSourceId":"aa450536-a078-4802-99fc-f07f5f47be66"},"text":".show tables details \n| project TableName, DatabaseName, Folder, TotalExtents, AuthorizedPrincipals\n| sort by TotalExtents desc","id":"32cdeb14-e742-4164-aedb-286dec339514","usedVariables":[]},{"dataSource":{"kind":"inline","dataSourceId":"500e3f05-5852-4ed8-97e4-0a49dba0743f"},"text":".show databases schema\n| where ColumnName != \"\"\n| summarize make_set(ColumnName), Count_of_Columns=count(ColumnName) by DatabaseName, TableName \n| sort by DatabaseName asc ","id":"d94035e0-2962-4bea-a7dc-a06f4b7ab5d7","usedVariables":[]},{"dataSource":{"kind":"inline","dataSourceId":"e2531940-8a59-446c-8122-da1fb5dc7e6f"},"text":"let findSourceIPLogs = (arg0: string, arg1: string) {\n    union withsource=_TableName *  \n    | where ingestion_time()  between (_startTime .. _endTime)\n};\nfindSourceIPLogs(\"Endpoint\", (\"term_t\"))\n| where record contains (term_t)\n| take 500\n| summarize\n    make_set(record, 500),\n    dcount(tostring(record)),\n    make_set(ingestion_time(), 500)\n    by _TableName\n| sort by dcount_record","id":"6adfc8a2-2560-42e6-8e7b-73002377f51a","usedVariables":["_endTime","_startTime","term_t"]}]}